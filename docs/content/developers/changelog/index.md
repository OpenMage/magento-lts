# Important changes

Most important changes will be listed here, all other changes since `19.4.0` can be found in
[release](https://github.com/OpenMage/magento-lts/releases) notes.

## Between Magento 1.9.4.5 and OpenMage 19.x

- bug fixes and PHP 7.x, 8.0, 8.1 and 8.2 compatibility
- added config cache for system.xml ([#1916](https://github.com/OpenMage/magento-lts/pull/1916))
- added `frontend_type` `color` ([#2945](https://github.com/OpenMage/magento-lts/pull/2945))
- search for `null` ("NULL") in backend grids ([#1203](https://github.com/OpenMage/magento-lts/pull/1203))
- removed `lib/flex` containing unused ActionScript "file uploader" files ([#2271](https://github.com/OpenMage/magento-lts/pull/2271))
- `Mage_Catalog_Model_Resource_Abstract::getAttributeRawValue()` now returns `'0'` instead of `false` if the value stored in the database is `0` ([#572](https://github.com/OpenMage/magento-lts/pull/572))
- PHP extension `intl` is required
- Deprecation errors are not suppressed anymore
- removed modules:
    - `Mage_Backup` ([#2811](https://github.com/OpenMage/magento-lts/pull/2811))
    - `Mage_Compiler`
    - `Mage_GoogleBase`
    - `Mage_PageCache` ([#2258](https://github.com/OpenMage/magento-lts/pull/2258))
    - `Mage_Poll` ([#3098](https://github.com/OpenMage/magento-lts/pull/3098))
    - `Mage_Xmlconnect`
    - `Phoenix_Moneybookers`

_If you rely on those modules you can reinstall them with composer:_

- Module `Mage_Backup`

  ```bash
  composer require openmage/module-mage-backup
  ```

- Module `Mage_PageCache`

  ```bash
  composer require openmage/module-mage-pagecache
  ```

- Module `Mage_Poll`

  ```bash
  composer require openmage/module-mage-poll
  ```

- Legacy frontend themes

  ```bash
  composer require openmage/legacy-frontend-themes
  ```

## Between OpenMage 19.x and 20.x

Do not use 20.x.x if you need IE support.

- removed IE conditional comments, IE styles, IE scripts and IE eot files ([#1073](https://github.com/OpenMage/magento-lts/pull/1073))
- removed frontend default themes (default, modern, iphone, german, french, blank, blue) ([#1600](https://github.com/OpenMage/magento-lts/pull/1600))
- fixed incorrect datetime in customer block (`$useTimezone` parameter) ([#1525](https://github.com/OpenMage/magento-lts/pull/1525))
- added redis as a valid option for `global/session_save` ([#1513](https://github.com/OpenMage/magento-lts/pull/1513))
- reduce needless saves by avoiding setting `_hasDataChanges` flag ([#2066](https://github.com/OpenMage/magento-lts/pull/2066))
- removed support for `global/sales/old_fields_map` defined in XML ([#921](https://github.com/OpenMage/magento-lts/pull/921))
- enabled website level config cache ([#2355](https://github.com/OpenMage/magento-lts/pull/2355))
- made overrides of `Mage_Core_Model_Resource_Db_Abstract::delete` respect parent api ([#1257](https://github.com/OpenMage/magento-lts/pull/1257))
- rewrote `Mage_Eav_Model_Config` as cache for all eav entity and attribute reads ([#2993](https://github.com/OpenMage/magento-lts/pull/2993))

For full list of changes, you can [compare tags](https://github.com/OpenMage/magento-lts/compare/1.9.4.x...20.0).

## Since OpenMage 19.5.0 / 20.1.0

PHP 7.4 is now the minimum required version.

Most of the 3rd party libraries/modules that were bundled in our repository were removed and migrated to composer dependencies.
This allows for better maintenance and upgradability.

Specifically:

- `phpseclib`
- `mcrypt_compat`
- `Cm_RedisSession`
- `Cm_Cache_Backend_Redis`
- `Pelago_Emogrifier` ([#2411](https://github.com/OpenMage/magento-lts/pull/2411))
- Zend Framework 1 ([#2827](https://github.com/OpenMage/magento-lts/pull/2827))

If your project uses OpenMage through composer then all dependencies will be managed automatically.  
If you just extracted the release zip/tarball in your project's main folder then be sure to:
- remove the old copy of aforementioned libraries from your project, you can do that with this command:
  ```bash
  rm -rf app/code/core/Zend lib/Cm lib/Credis lib/mcryptcompat lib/Pelago lib/phpseclib lib/Zend
  ```

- download the new release zip file that is named `openmage-VERSIONNUMBER.zip`, this one is built to contain the `vendor`
  folder generated by composer, with all the dependencies in it
- extract the zip file in your project's repository as you always did

We also decided to remove our Zend_DB patches (that were stored in `app/code/core/Zend`) because they were very old and
not compatible with the new implementations made by ZF1-Future, which is much more advanced and feature rich.
This may generate a problem with `Zend_Db_Select` statements that do not use `Zend_Db_Expr` to quote expressions.
If you see SQL errors after upgrading please remember to check for this specific issue in your code.

UPS shut down their old CGI APIs, so we removed the support for it from the `Mage_Usa` module.

## Between OpenMage 20.x and 21.x (unreleased, available on branch `next`)

- PHP 8.1 as minimum required version
- Removed `scriptaculous/dragdrop.js` ([#3215](https://github.com/OpenMage/magento-lts/pull/3215))
- RWD theme: updated jQuery to 3.7.0 ([#3204](https://github.com/OpenMage/magento-lts/pull/3204))
- Unified CSRF configuration ([#3147](https://github.com/OpenMage/magento-lts/pull/3147)) and added form key validation to Contacts form ([#3146](https://github.com/OpenMage/magento-lts/pull/3146))
- Removed double span element from HTML buttons ([#3123](https://github.com/OpenMage/magento-lts/pull/3123))
- Removed all deprecated `Mysql4_` classes ([#2730](https://github.com/OpenMage/magento-lts/pull/2730)). If there are any old modules/extensions in your installation that use such classes, you must run `shell/rename-mysql4-class-to-resource.php` in the command line in order to convert them. Backup all files before running the script
- Removed "admin routing compatibility mode" ([#1551](https://github.com/OpenMage/magento-lts/pull/1551))
